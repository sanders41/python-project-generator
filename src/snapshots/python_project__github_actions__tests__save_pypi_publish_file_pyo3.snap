---
source: src/github_actions.rs
expression: content
---
"name: PyPi Publish\non:\n  release:\n    types:\n    - published\npermissions:\n  contents: read\njobs:\n  linux:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        target: [x86_64, x86, aarch64, armv7, s390x, ppc64le]\n    steps:\n      - uses: actions/checkout@v5\n      - uses: actions/setup-python@v6\n        with:\n          python-version: \"3.12\"\n      - name: Build wheels\n        uses: PyO3/maturin-action@v1\n        with:\n          target: ${{ matrix.target }}\n          args: --release --out dist --find-interpreter\n          sccache: 'true'\n          manylinux: auto\n      - name: Upload wheels\n        uses: actions/upload-artifact@v4\n        with:\n          name: wheels-linux-${{ matrix.target }}\n          path: dist\n  windows:\n    runs-on: windows-latest\n    strategy:\n      matrix:\n        target: [x64, x86]\n    steps:\n      - uses: actions/checkout@v5\n      - uses: actions/setup-python@v6\n        with:\n          python-version: \"3.12\"\n          architecture: ${{ matrix.target }}\n      - name: Build wheels\n        uses: PyO3/maturin-action@v1\n        with:\n          target: ${{ matrix.target }}\n          args: --release --out dist --find-interpreter\n          sccache: 'true'\n      - name: Upload wheels\n        uses: actions/upload-artifact@v4\n        with:\n          name: wheels-windows-${{ matrix.target }}\n          path: dist\n  macos:\n    runs-on: macos-latest\n    strategy:\n      matrix:\n        target: [x86_64, aarch64]\n    steps:\n      - uses: actions/checkout@v5\n      - uses: actions/setup-python@v6\n        with:\n          python-version: \"3.12\"\n      - name: Build wheels\n        uses: PyO3/maturin-action@v1\n        with:\n          target: ${{ matrix.target }}\n          args: --release --out dist --find-interpreter\n          sccache: 'true'\n      - name: Upload wheels\n        uses: actions/upload-artifact@v4\n        with:\n          name: wheels-macos-${{ matrix.target }}\n          path: dist\n  sdist:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v5\n      - uses: actions/setup-python@v6\n        with:\n          python-version: \"3.12\"\n      - name: Build sdist\n        uses: PyO3/maturin-action@v1\n        with:\n          command: sdist\n          args: --out dist\n      - name: Upload sdist\n        uses: actions/upload-artifact@v4\n        with:\n          name: wheels-sdist\n          path: dist\n  release:\n    name: Release\n    runs-on: ubuntu-latest\n    permissions:\n      # For PyPI's trusted publishing.\n      id-token: write\n    if: \"startsWith(github.ref, 'refs/tags/')\"\n    needs: [linux, windows, macos, sdist]\n    steps:\n      - uses: actions/download-artifact@v4\n      - uses: actions/setup-python@v6\n        with:\n          python-version: \"3.12\"\n      - name: Publish to PyPI\n        uses: PyO3/maturin-action@v1\n        with:\n          command: upload\n          args: --non-interactive --skip-existing wheels-*/*\n"
